<!DOCTYPE html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>林頌堅 (Sung-Chien Lin) - 個人履歷</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" xintegrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts: Noto Sans TC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Apply the font to the body */
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        /* Custom style for active menu item */
        .nav-active {
            color: #dbeafe; /* Light blue for active state */
            font-weight: 700;
        }
        /* Spinner for loading animation */
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-b from-blue-50 via-gray-50 to-white text-gray-800">

    <!-- Header Section -->
    <header id="home" class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="max-w-5xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <!-- Name -->
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-blue-900">林頌堅</h1>
                    <p class="text-sm md:text-base text-blue-700">Sung-Chien Lin</p>
                </div>
                <!-- Navigation Menu -->
                <nav class="hidden lg:block">
                    <ul class="flex space-x-6 text-gray-600">
                        <li><a href="#about" class="hover:text-blue-600 transition duration-300">個人簡介</a></li>
                        <li><a href="#position" class="hover:text-blue-600 transition duration-300">現職</a></li>
                        <li><a href="#education" class="hover:text-blue-600 transition duration-300">學歷</a></li>
                        <li><a href="#expertise" class="hover:text-blue-600 transition duration-300">專長</a></li>
                        <li><a href="#interests" class="hover:text-blue-600 transition duration-300">個人興趣</a></li>
                    </ul>
                </nav>
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="lg:hidden p-2 rounded-md text-blue-800 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500">
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu, hidden by default -->
        <div id="mobile-menu" class="hidden lg:hidden">
            <ul class="px-6 pb-4 space-y-2 text-center">
                 <li><a href="#about" class="block py-2 text-gray-700 hover:bg-blue-100 rounded-md transition duration-300">個人簡介</a></li>
                 <li><a href="#position" class="block py-2 text-gray-700 hover:bg-blue-100 rounded-md transition duration-300">現職</a></li>
                 <li><a href="#education" class="block py-2 text-gray-700 hover:bg-blue-100 rounded-md transition duration-300">學歷</a></li>
                 <li><a href="#expertise" class="block py-2 text-gray-700 hover:bg-blue-100 rounded-md transition duration-300">專長</a></li>
                 <li><a href="#interests" class="block py-2 text-gray-700 hover:bg-blue-100 rounded-md transition duration-300">個人興趣</a></li>
            </ul>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-5xl mx-auto px-6 py-12">

        <!-- Section 1: About -->
        <section id="about" class="mb-16 scroll-mt-24">
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <div class="md:flex md:items-center md:gap-8">
                    <!-- Profile Picture -->
                    <div class="flex-shrink-0 text-center md:text-left mb-6 md:mb-0">
                        <img class="w-40 h-40 md:w-48 md:h-48 rounded-full mx-auto shadow-md border-4 border-white object-cover" 
                             src="https://sungchien.github.io/assets/img/profile.jpg" 
                             alt="林頌堅個人照片"
                             onerror="this.onerror=null;this.src='https://placehold.co/192x192/EBF8FF/3182CE?text=SCL';">
                    </div>
                    <!-- Intro Text -->
                    <div class="space-y-4">
                        <div>
                            <h2 class="text-3xl font-bold text-blue-900 pb-3 mb-4">關於我</h2>
                            <p class="text-gray-700 leading-relaxed">我對於資料科學和資訊視覺化相當有興趣，喜歡研究R語言和Python等程式設計以及政府開放資料的應用。此外，我對網站規劃與設計的方法與技術也有涉獵。</p>
                            <p class="text-gray-500 mt-2 leading-relaxed text-sm">I am very interested in data science and information visualization. I also like to study R and Python programming, as well as the application of open government data. In addition, I study the methods and techniques about website planning and design.</p>
                        </div>
                        <div class="border-t border-gray-200 pt-4">
                             <p class="text-gray-600"><strong class="text-blue-800">地址:</strong> 台北市木柵路一段十七巷一號</p>
                             <p class="text-gray-500 text-sm">No. 17, Sec. 1, Rd. Mu-Cha, Taipei City, Taiwan</p>
                             <p class="text-gray-600"><strong class="text-blue-800">個人網址：</strong><a href="https://sungchien.github.io/">https://sungchien.github.io/</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Current Position -->
        <section id="position" class="mb-16 scroll-mt-24">
            <h2 class="flex items-center text-3xl font-bold text-blue-900 border-b-2 border-blue-200 pb-3 mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                現職
            </h2>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <ul class="space-y-4 list-none">
                    <li class="flex items-start"><span class="text-blue-500 mr-3 mt-1">&#10148;</span><p>世新大學 資訊傳播學系 副教授</p></li>
                    <li class="flex items-start"><span class="text-blue-500 mr-3 mt-1">&#10148;</span><p>國防大學 政治作戰學院 新聞學系 兼任副教授</p></li>
                    <li class="flex items-start"><span class="text-blue-500 mr-3 mt-1">&#10148;</span><p>臺灣大學 圖書資訊學系暨研究所 兼任副教授</p></li>
                </ul>
            </div>
        </section>

        <!-- Section 3: Education -->
        <section id="education" class="mb-16 scroll-mt-24">
            <h2 class="flex items-center text-3xl font-bold text-blue-900 border-b-2 border-blue-200 pb-3 mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M12 14l9-5-9-5-9 5 9 5z" /><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-5.998 12.078 12.078 0 01.665-6.479L12 14z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-5.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222 4 2.222V20M1 12v7a2 2 0 002 2h18a2 2 0 002-2v-7" /></svg>
                學歷
            </h2>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <ul class="space-y-5">
                    <li><p class="font-semibold text-blue-800">資訊工程學 博士</p><p class="text-gray-600">國立臺灣大學 (National Taiwan University)</p></li>
                    <li class="border-t border-gray-100 pt-5"><p class="font-semibold text-blue-800">資訊工程學 碩士</p><p class="text-gray-600">國立臺灣大學 (National Taiwan University)</p></li>
                    <li class="border-t border-gray-100 pt-5"><p class="font-semibold text-blue-800">資訊工程學 學士</p><p class="text-gray-600">國立交通大學 (National Chiao Tung University)</p></li>
                </ul>
            </div>
        </section>

        <!-- Section 4: Expertise -->
        <section id="expertise" class="mb-16 scroll-mt-24">
            <h2 class="flex items-center text-3xl font-bold text-blue-900 border-b-2 border-blue-200 pb-3 mb-6">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                 專長
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Skill Card -->
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">自然語言處理</h3><p class="text-gray-500 text-sm">Natural Language Processing</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="自然語言處理">✨ 深入了解</button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">資訊檢索</h3><p class="text-gray-500 text-sm">Information Retrieval</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="資訊檢索">✨ 深入了解</button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4M4 7s0 0 0 0l8 5 8-5M12 22V12" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">資料/文本探勘</h3><p class="text-gray-500 text-sm">Data/Text Mining</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="資料探勘與文本探勘">✨ 深入了解</button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" /><path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">資訊視覺化</h3><p class="text-gray-500 text-sm">Information Visualization</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="資訊視覺化">✨ 深入了解</button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">網站規劃與設計</h3><p class="text-gray-500 text-sm">Website Planning & Design</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="網站規劃與設計">✨ 深入了解</button>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-start h-full">
                    <div class="flex items-center space-x-4 mb-3 w-full">
                        <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg></div>
                        <div><h3 class="font-semibold text-blue-900">使用者經驗研究</h3><p class="text-gray-500 text-sm">User Experience Design</p></div>
                    </div>
                    <button class="elaborate-skill-btn mt-auto text-sm text-blue-600 hover:text-blue-800 font-semibold" data-skill="使用者經驗研究">✨ 深入了解</button>
                </div>
            </div>
        </section>

        <!-- Section 5: Interests -->
        <section id="interests" class="mb-16 scroll-mt-24">
            <h2 class="flex items-center text-3xl font-bold text-blue-900 border-b-2 border-blue-200 pb-3 mb-6">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>
                 個人興趣
            </h2>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                 <p class="text-gray-700 leading-relaxed mb-6">I enjoy many kinds of outdoor activities, such as biking, hiking, jogging, and swimming. I usually run, sometimes walk, along the Jingmei Stream in the morning. I like to ride a bicycle to the outskirts of Taipei on holidays. I also enjoy reading in my daily life.</p>
                 <div class="flex flex-wrap justify-center gap-6 pt-6 border-t border-gray-100">
                    <div class="text-center text-gray-600"><div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2"><i class="fas fa-biking fa-3x text-blue-500"></i></div>Biking</div>
                    <div class="text-center text-gray-600"><div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2"><i class="fas fa-hiking fa-3x text-blue-500"></i></div>Hiking</div>
                    <div class="text-center text-gray-600"><div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2"><i class="fas fa-running fa-3x text-blue-500"></i></div>Jogging</div>
                    <div class="text-center text-gray-600"><div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2"><i class="fas fa-swimmer fa-3x text-blue-500"></i></div>Swimming</div>
                    <div class="text-center text-gray-600"><div class="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2"><i class="fas fa-book-reader fa-3x text-blue-500"></i></div>Reading</div>
                 </div>
            </div>
        </section>
        
        <!-- Section 6: Gemini Idea Generator -->
        <section id="gemini-idea" class="mb-16 scroll-mt-24">
            <h2 class="flex items-center text-3xl font-bold text-blue-900 border-b-2 border-blue-200 pb-3 mb-6">
                <i class="fas fa-lightbulb fa-fw mr-3 text-yellow-400"></i>
                AI 協作點子產生器
            </h2>
            <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 text-center">
                 <p class="text-gray-700 leading-relaxed mb-6">想看看我的專業技能和個人興趣能碰撞出什麼樣的火花嗎？點擊下方按鈕，讓 AI 為我們發想一個創新的跨領域專案點子！</p>
                 <button id="generate-idea-btn" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1">
                    ✨ 產生一個專案點子
                 </button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-blue-900 text-white text-center py-6 mt-12">
        <p class="text-sm">製作日期：<span id="creation-date"></span></p>
    </footer>

    <!-- Gemini Modal -->
    <div id="gemini-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 id="modal-title" class="text-xl font-bold text-blue-900"></h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modal-content" class="p-6 overflow-y-auto">
                <!-- Content will be injected here -->
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Basic Page Functionality ---
            document.getElementById('creation-date').textContent = new Date().toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' });
            
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            
            const mobileMenuLinks = mobileMenu.querySelectorAll('#mobile-menu a');
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });

            // --- Gemini API and Modal Functionality ---
            const modal = document.getElementById('gemini-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const closeModalBtn = document.getElementById('close-modal-btn');

            const apiKey = ""; // Canvas will provide the key
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            // --- Modal Controls ---
            const showModal = () => modal.classList.remove('hidden');
            const hideModal = () => modal.classList.add('hidden');
            
            const showLoading = (title) => {
                modalTitle.textContent = title;
                modalContent.innerHTML = '<div class="flex justify-center items-center p-10"><div class="loader"></div></div>';
                showModal();
            };

            const displayResult = (title, content) => {
                modalTitle.textContent = title;
                // Basic markdown to HTML conversion for lists and bolding
                let htmlContent = content
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Bold
                    .replace(/\n\s*\*\s/g, '\n<li class="mt-2">') // List items
                    .replace(/(\<li.*\>.*)/g, '<ul>$1</ul>') // Wrap in ul
                    .replace(/<\/li>\n<ul>/g, '</li><ul>')
                    .replace(/\n/g, '<br>'); // Newlines
                modalContent.innerHTML = `<div class="prose max-w-none text-gray-700 leading-relaxed">${htmlContent}</div>`;
            };
            
            const displayError = () => {
                 modalTitle.textContent = '發生錯誤';
                 modalContent.innerHTML = '<p class="text-red-500 text-center">無法連線至 AI 模型，請稍後再試。</p>';
            };

            closeModalBtn.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    hideModal();
                }
            });
            
            // --- API Call Logic ---
            const callGeminiAPI = async (prompt, systemPrompt = null) => {
                let retries = 3;
                let delay = 1000;

                while (retries > 0) {
                    try {
                        const payload = {
                            contents: [{ parts: [{ text: prompt }] }],
                        };

                        if (systemPrompt) {
                            payload.systemInstruction = { parts: [{ text: systemPrompt }] };
                        }
                        
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                             throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                        
                        if (text) {
                            return text;
                        } else {
                            throw new Error('Invalid API response structure.');
                        }

                    } catch (error) {
                        console.error('API call failed:', error);
                        retries--;
                        if (retries === 0) {
                            return null;
                        }
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2; // Exponential backoff
                    }
                }
                return null;
            };

            // --- Event Listeners for Gemini Features ---
            
            // 1. Elaborate on Skills
            const elaborateSkillBtns = document.querySelectorAll('.elaborate-skill-btn');
            elaborateSkillBtns.forEach(btn => {
                btn.addEventListener('click', async () => {
                    const skill = btn.dataset.skill;
                    showLoading(`解析：${skill}`);
                    
                    const prompt = `請用平易近人、簡潔且引人入勝的方式，說明「${skill}」是什麼。內容包含：\n1. 一句核心概念的總結。\n2. 一個生活化的應用實例。\n請用繁體中文回答。`;
                    const systemPrompt = "你是一位知識淵博且善於教學的科技專家，能將複雜概念轉化為簡單易懂的說明。";
                    
                    const result = await callGeminiAPI(prompt, systemPrompt);
                    if (result) {
                        displayResult(`關於「${skill}」`, result);
                    } else {
                        displayError();
                    }
                });
            });

            // 2. Generate Project Idea
            const generateIdeaBtn = document.getElementById('generate-idea-btn');
            generateIdeaBtn.addEventListener('click', async () => {
                showLoading('正在產生專案點子...');

                const prompt = `請根據一位台灣教授的個人檔案，發想一個具體的、創新的、結合專業與興趣的跨領域專案點子。點子需包含一個響亮的標題和一段約100-150字的說明。\n\n**教授檔案：**\n- **專業領域：** 自然語言處理, 資訊檢索, 資料探勘、文本探勘, 資訊視覺化, 網站規劃與設計, 使用者經驗研究。\n- **個人興趣：** 騎單車, 登山, 慢跑, 游泳, 閱讀。\n\n請用繁體中文回答。`;
                const systemPrompt = "你是一位充滿創意的學術專案經理，擅長連結不同領域的知識，創造出令人興奮的合作計畫。";

                const result = await callGeminiAPI(prompt, systemPrompt);
                if (result) {
                    displayResult('✨ 跨領域專案點子', result);
                } else {
                    displayError();
                }
            });
        });
    </script>
</body>
</html>